<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My VM Network Sandbox</title>
    <link rel="icon" type="image/png" sizes="96x96" href="images/favicon.png" />
    <link rel="stylesheet" href="styles.css" />
    <style>
      /* Only for this page: make .bg-3d fixed and full viewport */
      .bg-3d {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        width: 100vw !important;
        height: 100vh !important;
        min-width: 100vw !important;
        min-height: 100vh !important;
        object-fit: cover !important;
        z-index: -1000 !important;
        pointer-events: none !important;
      }
    </style>
  </head>
  <body>
    <!-- 3D Video Background Layer -->
    <video class="bg-3d" autoplay muted loop playsinline>
      <source src="videos/background.mp4" type="video/mp4" />
      <source src="videos/background.webm" type="video/webm" />
      Your browser does not support the video tag.
    </video>

    <div class="background-wrapper">
      <!-- Dark/Light Theme Toggle -->
      <div class="theme-toggle-container">
        <label class="switch">
          <input type="checkbox" id="theme-toggle" />
          <span class="slider"></span>
        </label>
        <span id="theme-icon" class="theme-icon">🌙</span>
      </div>

      <div class="container">
        <section class="card full-width">
          <h1>My VM Network Sandbox</h1>
          <p>
            Welcome to my VM Network Sandbox!<br />
            This page is a placeholder for details, documentation, and resources
            related to the VirtualBox/Linux Server Lab project.
          </p>
          <p>
            <a
              href="https://github.com/jszolcek/Linux-Server-VM-Lab/tree/main"
              target="_blank"
              class="button-link"
            >
              <button class="dropdown-button">View on GitHub</button>
            </a>
          </p>
        </section>
        <section class="card full-width" style="background: #111; color: #fff;">
          <h3>🏗️ Home Lab Setup History</h3>
          <ol style="margin-left: 1.2em;">
            <li>💻 Created a new VirtualBox VM<br>Installed the latest Ubuntu Server 22.04 distro.</li>
            <li>🛠️ Installed essential programs on the VM<br>
              <ul>
                <li>OpenSSH Server (to enable SSH access)</li>
                <li>Prometheus (planning to add Grafana later)</li>
              </ul>
            </li>
            <li>🔍 Discovered VM IP address<br>Ran <code>ip a</code> on the VM, identified IP on interface <code>enp0s3</code>.</li>
            <li>🔄 Changed VirtualBox network adapter<br>Switched from Bridged to NAT for isolation.</li>
            <li>🔑 Set up SSH key authentication<br>
              <ul>
                <li>Generated SSH key on Windows host</li>
                <li>Added public key to <code>~/.ssh/authorized_keys</code> on VM</li>
                <li>Disabled password login on SSH server</li>
              </ul>
            </li>
            <li>🚪 Configured VirtualBox port forwarding<br>Forwarded host port 2222 to guest port 22 for SSH access.</li>
            <li>📄 Fixed public key format issue<br>
              <ul>
                <li>Extracted the public key from Windows private key using <code>ssh-keygen -y</code></li>
                <li>Manually added the corrected public key string to <code>~/.ssh/authorized_keys</code> on VM</li>
                <li>Set correct permissions on <code>.ssh</code> folder and <code>authorized_keys</code> file</li>
              </ul>
            </li>
            <li style="margin-left:2em;list-style-type:decimal-leading-zero;">🔗 Connected from Windows via SSH (passwordless)<br>Using forwarded port and SSH key for passwordless login.</li>
            <li>🛡️ Installed and configured Pi-hole on Linux server<br>Set up Pi-hole DNS server to block ads and trackers.</li>
            <li>📡 Tested Pi-hole blocking by pinging a known blocked domain<br>Used ping and dig commands on the server to confirm blocked queries appear in Pi-hole logs.<br>
              <img src="images/Pi-hole.png" alt="Pi-hole screenshot" style="max-width: 400px; width: 100%; margin: 1em 0; border-radius: 8px; box-shadow: 0 2px 8px #000;">
            </li>
          </ol>
          <hr style="margin:2em 0; border:1px solid #333;">
          <h3>🛠️ pfSense Setup</h3>
          <ol style="margin-left: 1.2em;">
            <li>🖥️ <b>Set up pfSense VM in VirtualBox</b><br>
              <ul>
                <li>Assigned WAN IP: <code>192.168.1.x/24</code></li>
                <li>Assigned LAN IP: <code>192.168.56.1/24</code></li>
                <li>Configured VirtualBox network adapters:
                  <ul>
                    <li>WAN as Bridged or NAT</li>
                    <li>LAN as Host-only Adapter (<code>vboxnet0</code>)</li>
                  </ul>
                </li>
              </ul>
            </li>
            <li>🔌 <b>Configured pfSense interfaces</b><br>
              <ul>
                <li>WAN on <code>192.168.1.x</code></li>
                <li>LAN on <code>192.168.56.1</code></li>
                <li>Enabled DHCP server on LAN for automatic IP assignment</li>
              </ul>
            </li>
            <li>🖧 <b>Checked network connectivity</b><br>
              <ul>
                <li>Ping from VM to host on LAN interface: <b>successful</b></li>
                <li>Tried to access <code>http://192.168.56.1</code> from host: <b>connection refused</b></li>
              </ul>
            </li>
            <li>🔍 <b>Diagnosed network reachability</b><br>
              <ul>
                <li>Used <code>arp -a</code> on host to check MAC address resolution</li>
                <li>Confirmed host did <b>not</b> initially see pfSense MAC</li>
              </ul>
            </li>
            <li>🛠️ <b>Removed and reassigned VirtualBox Host-Only Network adapter</b> (questioned myself again for the 4,213,125th time why I'm doing this via VM's and not just on a spare old pc)<br>
              <ul>
                <li>Deleted existing Host-Only adapter causing issues</li>
                <li>Created a new Host-Only adapter (<code>vboxnet0</code>)</li>
                <li>Reassigned pfSense LAN interface to new adapter</li>
                <li>Restored MAC address visibility on host</li>
              </ul>
            </li>
            <li>🛡️ <b>Adjusted Windows firewall settings</b><br>
              <ul>
                <li>Temporarily disabled firewall on Host-only network adapter</li>
                <li>Disabled any third-party antivirus/firewall shields</li>
              </ul>
            </li>
            <li>📶 <b>Verified connectivity again</b><br>
              <ul>
                <li><code>arp -a</code> showed pfSense LAN MAC address (<code>192.168.56.1</code>) on host</li>
                <li>Ping from host to <code>192.168.56.1</code> succeeded</li>
              </ul>
            </li>
            <li>🌐 <b>Accessed pfSense Web GUI</b><br>
              <ul>
                <li>Opened <code>http://192.168.56.1</code> in browser</li>
                <li>Successfully loaded pfSense admin interface</li>
                <li><img src="images/pfSense.png" alt="pfSense screenshot" style="max-width: 400px; width: 100%; margin: 1em 0; border-radius: 8px; box-shadow: 0 2px 8px #000;"></li>
              </ul>
            </li>
          </ol>
        </section>
      </div>
    </div>

    <!-- Theme toggle & icon script -->
    <script>
      const themeToggle = document.getElementById("theme-toggle");
      const themeIcon = document.getElementById("theme-icon");

      function setTheme(isLight) {
        if (isLight) {
          document.body.classList.add("light-theme");
          if (themeIcon) themeIcon.textContent = "☀️";
        } else {
          document.body.classList.remove("light-theme");
          if (themeIcon) themeIcon.textContent = "🌙";
        }
      }

      // Load theme from localStorage if available
      if (themeToggle) {
        const savedTheme = localStorage.getItem("theme");
        if (savedTheme === "light") {
          themeToggle.checked = true;
          setTheme(true);
        }

        themeToggle.addEventListener("change", () => {
          setTheme(themeToggle.checked);
          localStorage.setItem("theme", themeToggle.checked ? "light" : "dark");
        });
      }
    </script>
  </body>
</html>
