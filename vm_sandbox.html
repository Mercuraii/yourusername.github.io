<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VM Network Sandbox</title>
    <link rel="icon" type="image/png" sizes="96x96" href="images/favicon.png" />
    <link rel="stylesheet" href="styles.css" />
    <!-- Style overrides for light theme text and large images -->
    <style>
      /* Make markdown text black in light mode */
      body.light-theme .card,
      body.light-theme .card * {
        color: #111 !important;
      }
      .card img.sandbox-img {
        max-width: 1000px !important;
        width: 100% !important;
        height: auto !important;
        margin: 1em 0;
        border-radius: 8px;
        box-shadow: 0 2px 8px #000;
        cursor: pointer;
        transition: box-shadow 0.2s, transform 0.2s;
      }
      .card img.sandbox-img:hover {
        box-shadow: 0 0 40px 8px #2196f3;
        transform: scale(1.1);
        z-index: 10;
      }
  
 
       /* Modal styles (synced with vm_sandbox.html, 100% screen height) */
      #imgModal {
        display: none;
        position: fixed;
        left: 0;
        top: 0;
        width: 100vw;
        height: 100vh;
        min-height: 100vh;
        background: rgba(0, 0, 0, 0.95);
        z-index: 2000;
        justify-content: center;
        align-items: center;
      }
      #imgModal img {
        max-width: 90vw;
        max-height: 90vh;
        border-radius: 12px;
        background: #222;
      }
      #imgModal:active,
      #imgModal .close {
        cursor: pointer;
      }
      #imgModal .close {
        position: absolute;
        top: 2vh;
        right: 4vw;
        font-size: 3rem;
        color: #fff;
        z-index: 2100;
        background: none;
        border: none;
      }

      body.light-theme .button-link .dropdown-button {
        background: #000 !important;
        color: #fff !important;
      }
      body.light-theme .button-link .dropdown-button:hover {
        background: #222 !important;
        color: #fff !important;
      }
      #returnBtn {
        position: absolute;
        top: 20px;
        left: 20px;
        padding: 8px 12px;
        background-color: #444;
        color: #eee;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.3s, box-shadow 0.3s;
        z-index: 1000;
        text-decoration: none;
        font-size: 16px;
        display: inline-block;
        font-weight: 600;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        outline: none;
      }
      #returnBtn:hover,
      #returnBtn:focus {
        background-color: #666;
        text-decoration: none;
        color: #fff;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4);
      }
      #returnBtn:active {
        background-color: #888;
        color: #fff;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
      }
    </style>
    <head>
      <!-- other head stuff -->

      <script>
        function resizeBgVideo() {
          const video = document.querySelector(".bg-3d");
          if (video) {
            video.style.height =
              Math.max(document.body.scrollHeight, window.innerHeight) + "px";
          }
        }
        window.addEventListener("resize", resizeBgVideo);
        window.addEventListener("DOMContentLoaded", resizeBgVideo);
      </script>
    </head>
  </head>
  <body>
    <a id="returnBtn" href="https://jszolcek.github.io/index.html">Return</a>
    <!-- 3D Video Background Layer -->
    <video class="bg-3d" autoplay muted loop playsinline>
      <source src="videos/background.mp4" type="video/mp4" />
      <source src="videos/background.webm" type="video/webm" />
      Your browser does not support the background video tag.
    </video>

    <div class="background-wrapper">
      <!-- Dark/Light Theme Toggle -->
      <div class="theme-toggle-container">
        <label class="switch">
          <input type="checkbox" id="theme-toggle" />
          <span class="slider"></span>
        </label>
        <span id="theme-icon" class="theme-icon">üåô</span>
      </div>

      <div class="container">
        <section class="card full-width">
          <h1>VM Network Sandbox üèñÔ∏èüîß</h1>
          <p>
            This page is a placeholder for details, documentation, and resources
            related to the VirtualBox/Linux Server Lab project/s I've been
            working on.

            <br /><br />
          </p>
          <p>
            <a
              href="https://github.com/jszolcek/Linux-Server-VM-Lab/tree/main"
              target="_blank"
              class="button-link"
            >
              <button class="dropdown-button">View on GitHub</button>
            </a>
          </p>
        </section>
        <section class="card full-width" style="background: #111; color: #fff">
          <h3>üèóÔ∏è Home Lab Setup History</h3>
          <ol style="margin-left: 1.2em">
            <li>
              üíª Created a new VirtualBox VM<br />Installed the latest Ubuntu
              Server 22.04 distro.
            </li>
            <li>
              üõ†Ô∏è Installed essential programs on the VM<br />
              <ul>
                <li>OpenSSH Server (to enable SSH access)</li>
                <li>Prometheus (planning to add Grafana later)</li>
              </ul>
            </li>
            <li>
              üîç Discovered VM IP address<br />Ran <code>ip a</code> on the VM,
              identified IP on interface <code>enp0s3</code>.
            </li>
            <li>
              üîÑ Changed VirtualBox network adapter<br />Switched from Bridged
              to NAT for isolation.
            </li>
            <li>
              üîë Set up SSH key authentication<br />
              <ul>
                <li>Generated SSH key on Windows host</li>
                <li>
                  Added public key to <code>~/.ssh/authorized_keys</code> on VM
                </li>
                <li>Disabled password login on SSH server</li>
              </ul>
            </li>
            <li>
              üö™ Configured VirtualBox port forwarding<br />Forwarded host port
              2222 to guest port 22 for SSH access.
            </li>
            <li>
              üìÑ Fixed public key format issue<br />
              <ul>
                <li>
                  Extracted the public key from Windows private key using
                  <code>ssh-keygen -y</code>
                </li>
                <li>
                  Manually added the corrected public key string to
                  <code>~/.ssh/authorized_keys</code> on VM
                </li>
                <li>
                  Set correct permissions on <code>.ssh</code> folder and
                  <code>authorized_keys</code> file
                </li>
              </ul>
            </li>
            <li style="margin-left: 2em; list-style-type: decimal-leading-zero">
              üîó Connected from Windows via SSH (passwordless)<br />Using
              forwarded port and SSH key for passwordless login.
            </li>
            <li>
              üõ°Ô∏è Installed and configured Pi-hole on Linux server<br />Set up
              Pi-hole DNS server to block ads and trackers.
            </li>
            <li>
              üì° Tested Pi-hole blocking by pinging a known blocked domain<br />Used
              ping and dig commands on the server to confirm blocked queries
              appear in Pi-hole logs.<br />
              <img
                src="https://raw.githubusercontent.com/jszolcek/Linux-Server-VM-Lab/refs/heads/main/images/Pi-hole.png"
                alt="Pi-hole screenshot"
                class="sandbox-img"
                style="
                  max-width: 400px;
                  width: 100%;
                  margin: 1em 0;
                  border-radius: 8px;
                  box-shadow: 0 2px 8px #000;
                  cursor: pointer;
                "
              />
            </li>
          </ol>
          <hr style="margin: 2em 0; border: 1px solid #333" />
          <h3>üõ†Ô∏è pfSense Setup</h3>
          <ol style="margin-left: 1.2em">
            <li>
              üñ•Ô∏è <b>Set up pfSense VM in VirtualBox</b><br />
              <ul>
                <li>Assigned WAN IP: <code>192.168.1.x/24</code></li>
                <li>Assigned LAN IP: <code>192.168.56.1/24</code></li>
                <li>
                  Configured VirtualBox network adapters:
                  <ul>
                    <li>WAN as Bridged or NAT</li>
                    <li>LAN as Host-only Adapter (<code>vboxnet0</code>)</li>
                  </ul>
                </li>
              </ul>
            </li>
            <li>
              üîå <b>Configured pfSense interfaces</b><br />
              <ul>
                <li>WAN on <code>192.168.1.x</code></li>
                <li>LAN on <code>192.168.56.1</code></li>
                <li>Enabled DHCP server on LAN for automatic IP assignment</li>
              </ul>
            </li>
            <li>
              üñß <b>Checked network connectivity</b><br />
              <ul>
                <li>
                  Ping from VM to host on LAN interface: <b>successful</b>
                </li>
                <li>
                  Tried to access <code>http://192.168.56.1</code> from host:
                  <b>connection refused</b>
                </li>
              </ul>
            </li>
            <li>
              üîç <b>Diagnosed network reachability</b><br />
              <ul>
                <li>
                  Used <code>arp -a</code> on host to check MAC address
                  resolution
                </li>
                <li>Confirmed host did <b>not</b> initially see pfSense MAC</li>
              </ul>
            </li>
            <li>
              üõ†Ô∏è
              <b>Removed and reassigned VirtualBox Host-Only Network adapter</b>
              (questioned myself again for the 4,213,125th time why I'm doing
              this via VM's and not just on a spare old pc)<br />
              <ul>
                <li>Deleted existing Host-Only adapter causing issues</li>
                <li>Created a new Host-Only adapter (<code>vboxnet0</code>)</li>
                <li>Reassigned pfSense LAN interface to new adapter</li>
                <li>Restored MAC address visibility on host</li>
              </ul>
            </li>
            <li>
              üõ°Ô∏è <b>Adjusted Windows firewall settings</b><br />
              <ul>
                <li>
                  Temporarily disabled firewall on Host-only network adapter
                </li>
                <li>Disabled any third-party antivirus/firewall shields</li>
              </ul>
            </li>
            <li>
              üì∂ <b>Verified connectivity again</b><br />
              <ul>
                <li>
                  <code>arp -a</code> showed pfSense LAN MAC address
                  (<code>192.168.56.1</code>) on host
                </li>
                <li>Ping from host to <code>192.168.56.1</code> succeeded</li>
              </ul>
            </li>
            <li>
              üåê <b>Accessed pfSense Web GUI</b><br />
              <ul>
                <li>Opened <code>http://192.168.56.1</code> in browser</li>
                <li>Successfully loaded pfSense admin interface</li>

                <img
                  src="https://github.com/jszolcek/Linux-Server-VM-Lab/blob/main/images/pfSense.png?raw=true"
                  alt="pfSense screenshot"
                  class="sandbox-img"
                  style="
                    max-width: 400px;
                    width: 100%;
                    margin: 1em 0;
                    border-radius: 8px;
                    box-shadow: 0 2px 8px #000;
                    cursor: pointer;
                  "
                />
              </ul>
            </li>
          </ol>
        </section>
      </div>
    </div>

    <!-- Modal for image popup -->
    <div id="imgModal">
      <button class="close" onclick="closeModal()">&times;</button>
      <img id="modalImg" src="" alt="Large view" />
    </div>

    <!-- Theme toggle & icon script -->
    <script>
      const themeToggle = document.getElementById("theme-toggle");
      const themeIcon = document.getElementById("theme-icon");

      function setTheme(isLight) {
        if (isLight) {
          document.body.classList.add("light-theme");
          if (themeIcon) themeIcon.textContent = "‚òÄÔ∏è";
        } else {
          document.body.classList.remove("light-theme");
          if (themeIcon) themeIcon.textContent = "üåô";
        }
      }

      // Load theme from localStorage if available
      if (themeToggle) {
        const savedTheme = localStorage.getItem("theme");
        if (savedTheme === "light") {
          themeToggle.checked = true;
          setTheme(true);
        }

        themeToggle.addEventListener("change", () => {
          setTheme(themeToggle.checked);
          localStorage.setItem("theme", themeToggle.checked ? "light" : "dark");
        });
      }

      // Modal image logic
      function closeModal() {
        const modal = document.getElementById("imgModal");
        modal.style.display = "none";
        modal.style.top = null;
        document.getElementById("modalImg").src = "";
      }

      document.querySelectorAll(".sandbox-img").forEach((img) => {
        img.addEventListener("click", function (e) {
          const modal = document.getElementById("imgModal");
          document.getElementById("modalImg").src = this.src;
          modal.style.display = "fixed";
        });
      });
      document
        .getElementById("imgModal")
        .addEventListener("click", function (e) {
          if (e.target === this) closeModal();
        });
    </script>
  </div>
  </body>
</html>
